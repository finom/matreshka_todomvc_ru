!function(t,e){"function"==typeof define&&define.amd?define(["matreshka"],e):"object"==typeof module&&module.exports?module.exports=e(require("matreshka")):e(t.Matreshka)}(this,function(t){"use strict";function e(t){return t in e?e[t]:void(this.type=t)}if(!t)throw Error("Matreshka is missing");var n=t.linkProps,r=t.onDebounce,h=t.on,a=t.set,i="undefined"!=typeof window?window:null;return t.extend(e.prototype,{parts:[],path:"/",hashPath:"!#/",init:function(){function e(){a(o,"hashPath",p.hash,{hashEvent:!0})}function s(){a(o,"path",p.pathname,{popEvent:!0})}if(this.initialized)return this;var o=this,u=o.type,p=document.location;return n(o,"parts","path",function(t){var e=t.replace(/\/\//g,"/").replace(/^\/|\/$/g,"");return e?e.split("/"):[]}),n(o,"path","parts",function(t){var e,n=[];for(e=0;e<t.length&&t[e];e++)n.push(t[e]);return n.length?"/"+n.join("/")+"/":"/"}),n(o,"hashPath","path",function(t){return t&&"/"!=t?"#!"+t:""}),n(o,"path","hashPath",function(t){return t?t.replace(/^#!/,""):""}),h(o,"change:parts",function(e){var n,r=e.value,h=e.previousValue,a=r.length==h.length;if(a)for(n=0;n<r.length;n++)if(r[n]!=h[n]){a=!1;break}a||t.trigger(o,"pathchange")}),i&&("hash"==u?(e(),i.addEventListener("hashchange",e),r(o,"change:hashPath",function(t){t&&t.hashEvent||(p.hash=o.hashPath)},!0)):"history"==u&&(s(),i.addEventListener("popstate",function(t){t.state&&t.state.validPush&&s()}),r(o,"change:path",function(t){t&&t.popEvent||history.pushState({validPush:!0},"",o.path+p.hash)},!0))),o.initialized=!0,o},subscribe:function(t,e){var n,r=this.init(),i=e.replace(/\/\//g,"/").replace(/^\/|\/$/g,"").split("/"),s=[],o=(i.filter(function(t){return"*"!=t}),[]);for(n=0;n<i.length;n++)"*"!=i[n]&&s.push("change:"+i[n]);for(h(t,s,function(e){if(!e||!e.routeSilent){var n,h,a=[];for(n=0;n<i.length&&(h="*"==i[n]?r.parts[n]:t[i[n]],h);n++)a.push(h);r.parts=a}}),h(r,"pathchange",function(){var e;for(e=0;e<i.length;e++)"*"!=i[e]&&a(t,i[e],r.parts[e]||null,{routeSilent:!0})}),n=0;n<i.length;n++)o.push("*"==t[i[n]]?r.parts[n]:t[i[n]]||r.parts[n]);for(n=0;n<i.length;n++)"undefined"==typeof t[i[n]]&&r.parts[n]&&"*"!=t[i[n]]&&t.set(i[n],r.parts[n],{routeSilent:!0});return r.parts=o,r}}),t.Router=e,t.Router.history=new e("history"),t.Router.hash=new e("hash"),t.initRouter=function(e,n,r){return t.Router[r||"hash"].subscribe(e,n),e},t.prototype.initRouter=function(e,n){return t.Router[n||"hash"].subscribe(this,e),this},e});
//# sourceMappingURL=matreshka-router.min.js.map
